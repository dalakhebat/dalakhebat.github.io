<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard Tindak Lanjut Kedeputian Dalaks</title>
  <script src="https://cdn.jsdelivr.net/npm/react@18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@babel/standalone@7.20.15/babel.min.js"></script>
  <script src="https://unpkg.com/feather-icons@4.28.0/dist/feather.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Custom Tailwind styles for extra flair */
    .gradient-header {
      background: linear-gradient(to right, #4f46e5, #7c3aed);
    }
    .table-row {
      transition: all 0.3s ease;
    }
    .table-row:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    }
    .btn-icon {
      transition: all 0.2s ease;
    }
    .btn-icon:hover {
      transform: scale(1.1);
    }
    /* Ensure Feather Icons are visible */
    [data-feather] {
      width: 20px !important;
      height: 20px !important;
      stroke: currentColor !important;
      stroke-width: 2 !important;
    }
  </style>
</head>
<body class="bg-gray-100">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useMemo, useEffect } = React;

    const DashboardTindakLanjut = () => {
      const pemberiTugasOptions = [
        'Menteri Investasi', 
        'Wakil Menteri Investasi', 
        'Sekretaris Kementerian', 
        'Deputi Dalaks',
        'Direktur Wilayah 1', 
        'Direktur Wilayah 2', 
        'Direktur Wilayah 3', 
        'Direktur Wilayah 4', 
        'Direktur Wilayah 5'
      ];
      
      const picOptions = [
        'Direktur Wilayah 1', 'Direktur Wilayah 2', 'Direktur Wilayah 3', 'Direktur Wilayah 4', 'Direktur Wilayah 5',
        'Kasubdit Wilayah 1', 'Kasubdit Wilayah 2', 'Kasubdit Wilayah 3', 'Kasubdit Wilayah 4', 'Kasubdit Wilayah 5',
        'Kabag TU Kedeputian', 'Satgas Investasi', 'Sandria', 'Dito', 'Arif', 'Hakim', 'Aji'
      ];
      
      const statusOptions = [
        { value: 'Belum Mulai', color: 'bg-gray-100 text-gray-800' },
        { value: 'Proses', color: 'bg-blue-100 text-blue-800' },
        { value: 'Selesai', color: 'bg-green-100 text-green-800' },
        { value: 'Diverifikasi', color: 'bg-purple-100 text-purple-800' }
      ];

      const sifatDisposisiOptions = [
        { value: 'Biasa', color: 'bg-gray-100 text-gray-700', priority: 1 },
        { value: 'Penting', color: 'bg-yellow-100 text-yellow-800', priority: 2 },
        { value: 'Segera', color: 'bg-orange-100 text-orange-800', priority: 3 },
        { value: 'Sangat Segera', color: 'bg-red-100 text-red-800', priority: 4 }
      ];

      const loadTasksFromStorage = () => {
        try {
          const stored = window.localStorage.getItem('dalaks-tasks');
          if (stored) {
            return JSON.parse(stored);
          }
        } catch (error) {
          console.error('Error loading tasks from storage:', error);
        }
        return [];
      };

      const [tasks, setTasks] = useState(loadTasksFromStorage);
      const [formData, setFormData] = useState({
        pemberiTugas: '',
        judulTugas: '',
        rincianTugas: '',
        disposisiPIC: [],
        deadline: '',
        status: 'Belum Mulai',
        sifatDisposisi: 'Biasa'
      });
      const [filters, setFilters] = useState({
        pemberiTugas: '',
        pic: '',
        status: '',
        deadline: '',
        sifatDisposisi: '',
        search: ''
      });
      const [sortConfig, setSortConfig] = useState({ key: null, direction: 'asc' });
      const [showForm, setShowForm] = useState(false);
      const [showFilters, setShowFilters] = useState(false);
      const [editingTaskId, setEditingTaskId] = useState(null);

      useEffect(() => {
        try {
          window.localStorage.setItem('dalaks-tasks', JSON.stringify(tasks));
        } catch (error) {
          console.error('Error saving tasks to storage:', error);
        }
      }, [tasks]);

      useEffect(() => {
        // Reinitialize Feather Icons after React renders
        setTimeout(() => {
          window.feather.replace();
        }, 0);
      }, [showForm, showFilters, tasks]);

      const getNextId = () => Math.max(...tasks.map(t => t.id), 0) + 1;

      const parseTaskItems = (rincianTugas) => {
        if (!rincianTugas) return [];
        return rincianTugas
          .split('\n')
          .filter(line => line.trim().startsWith('â€¢') || line.trim().startsWith('-'))
          .map((line, index) => ({
            id: index,
            text: line.replace(/^[â€¢-]\s*/, '').trim(),
            completed: false
          }));
      };

      const getTaskProgress = (task) => {
        if (!task.taskItems || task.taskItems.length === 0) return 0;
        const completed = task.taskItems.filter(item => item.completed).length;
        return Math.round((completed / task.taskItems.length) * 100);
      };

      const getProgressColor = (task) => {
        const today = new Date();
        const deadline = new Date(task.deadline);
        const diffTime = deadline - today;
        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
        const progress = getTaskProgress(task);

        if (progress === 100) return 'text-green-600';
        if (diffDays < 0) return 'text-red-600';
        if (diffDays <= 14) return 'text-yellow-600';
        return 'text-blue-600';
      };

      const getProgressBgColor = (task) => {
        const today = new Date();
        const deadline = new Date(task.deadline);
        const diffTime = deadline - today;
        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
        const progress = getTaskProgress(task);

        if (progress === 100) return 'bg-green-50';
        if (diffDays < 0) return 'bg-red-50';
        if (diffDays <= 14) return 'bg-yellow-50';
        return 'bg-blue-50';
      };

      const isNearDeadline = (deadline, status) => {
        if (status === 'Selesai' || status === 'Diverifikasi') return false;
        const today = new Date();
        const deadlineDate = new Date(deadline);
        const diffTime = deadlineDate - today;
        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
        return diffDays <= 3;
      };

      const getStatusColor = (status) => {
        return statusOptions.find(s => s.value === status)?.color || 'bg-gray-100 text-gray-800';
      };

      const getSifatDisposisiColor = (sifat) => {
        return sifatDisposisiOptions.find(s => s.value === sifat)?.color || 'bg-gray-100 text-gray-700';
      };

      const getSifatDisposisiPriority = (sifat) => {
        return sifatDisposisiOptions.find(s => s.value === sifat)?.priority || 1;
      };

      const isHighPriority = (sifat) => {
        const priority = getSifatDisposisiPriority(sifat);
        return priority >= 3;
      };

      const handleInputChange = (field, value) => {
        setFormData(prev => ({ ...prev, [field]: value }));
      };

      const handlePICToggle = (pic) => {
        setFormData(prev => ({
          ...prev,
          disposisiPIC: prev.disposisiPIC.includes(pic)
            ? prev.disposisiPIC.filter(p => p !== pic)
            : [...prev.disposisiPIC, pic]
        }));
      };

      const resetForm = () => {
        setFormData({
          pemberiTugas: '',
          judulTugas: '',
          rincianTugas: '',
          disposisiPIC: [],
          deadline: '',
          status: 'Belum Mulai',
          sifatDisposisi: 'Biasa'
        });
        setEditingTaskId(null);
      };

      const handleSubmit = () => {
        if (!formData.pemberiTugas || !formData.judulTugas || !formData.deadline) {
          alert('Harap lengkapi field yang wajib diisi');
          return;
        }
        
        const taskItems = parseTaskItems(formData.rincianTugas);
        
        if (editingTaskId) {
          setTasks(prev => prev.map(task => 
            task.id === editingTaskId 
              ? { ...formData, id: editingTaskId, taskItems, createdAt: task.createdAt }
              : task
          ));
        } else {
          const newTask = {
            ...formData,
            id: getNextId(),
            taskItems: taskItems,
            createdAt: new Date().toISOString()
          };
          setTasks(prev => [...prev, newTask]);
        }
        
        resetForm();
        setShowForm(false);
        alert(editingTaskId ? 'Tugas berhasil diperbarui!' : 'Tugas berhasil ditambahkan!');
      };

      const handleEditTask = (task) => {
        setFormData({
          pemberiTugas: task.pemberiTugas,
          judulTugas: task.judulTugas,
          rincianTugas: task.taskItems?.map(item => `â€¢ ${item.text}`).join('\n') || task.rincianTugas,
          disposisiPIC: task.disposisiPIC,
          deadline: task.deadline,
          status: task.status,
          sifatDisposisi: task.sifatDisposisi
        });
        setEditingTaskId(task.id);
        setShowForm(true);
      };

      const handleDeleteTask = (taskId) => {
        if (window.confirm('Apakah Anda yakin ingin menghapus tugas ini?')) {
          setTasks(prev => prev.filter(task => task.id !== taskId));
          alert('Tugas berhasil dihapus!');
        }
      };

      const toggleTaskItem = (taskId, itemId) => {
        setTasks(prev => prev.map(task => {
          if (task.id === taskId) {
            const updatedTaskItems = task.taskItems.map(item => 
              item.id === itemId ? { ...item, completed: !item.completed } : item
            );
            
            const completedItems = updatedTaskItems.filter(item => item.completed).length;
            const totalItems = updatedTaskItems.length;
            const progressPercentage = totalItems > 0 ? (completedItems / totalItems) * 100 : 0;
            
            let newStatus = task.status;
            if (progressPercentage === 0) {
              newStatus = 'Belum Mulai';
            } else if (progressPercentage === 100) {
              newStatus = 'Selesai';
            } else {
              newStatus = 'Proses';
            }
            
            return {
              ...task,
              taskItems: updatedTaskItems,
              status: newStatus
            };
          }
          return task;
        }));
      };

      const updateTaskStatus = (taskId, newStatus) => {
        setTasks(prev => prev.map(task => {
          if (task.id === taskId) {
            return { ...task, status: newStatus };
          }
          return task;
        }));
      };

      const filteredAndSortedTasks = useMemo(() => {
        let filtered = tasks.filter(task => {
          return (
            (!filters.pemberiTugas || task.pemberiTugas === filters.pemberiTugas) &&
            (!filters.pic || task.disposisiPIC.some(p => p.includes(filters.pic))) &&
            (!filters.status || task.status === filters.status) &&
            (!filters.deadline || task.deadline === filters.deadline) &&
            (!filters.sifatDisposisi || task.sifatDisposisi === filters.sifatDisposisi) &&
            (!filters.search || 
              task.judulTugas.toLowerCase().includes(filters.search.toLowerCase()) ||
              task.rincianTugas.toLowerCase().includes(filters.search.toLowerCase()) ||
              task.disposisiPIC.some(p => p.toLowerCase().includes(filters.search.toLowerCase()))
            )
          );
        });

        if (sortConfig.key) {
          filtered.sort((a, b) => {
            let aVal = a[sortConfig.key];
            let bVal = b[sortConfig.key];
            
            if (sortConfig.key === 'disposisiPIC') {
              aVal = aVal.join(', ');
              bVal = bVal.join(', ');
            }
            
            if (aVal < bVal) return sortConfig.direction === 'asc' ? -1 : 1;
            if (aVal > bVal) return sortConfig.direction === 'asc' ? 1 : -1;
            return 0;
          });
        }

        return filtered;
      }, [tasks, filters, sortConfig]);

      const requestSort = (key) => {
        setSortConfig(prev => ({
          key,
          direction: prev.key === key && prev.direction === 'asc' ? 'desc' : 'asc'
        }));
      };

      return (
        <div className="max-w-7xl mx-auto p-6 bg-white rounded-xl shadow-lg">
          <div className="mb-6 gradient-header text-white p-6 rounded-t-xl">
            <h1 className="text-3xl font-bold mb-2">Dashboard Tindak Lanjut Kedeputian Dalaks</h1>
            <div className="mt-2 text-sm bg-indigo-500/20 text-indigo-100 px-3 py-1 rounded-lg inline-block">
              âœ… Data tersimpan otomatis di browser - tidak akan hilang saat refresh
            </div>
          </div>

          <div className="flex flex-wrap gap-4 mb-6 items-center">
            <button
              onClick={() => setShowForm(!showForm)}
              className="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-colors shadow-md"
            >
              <i data-feather="plus" className="w-5 h-5"></i>
              {editingTaskId ? 'Edit Tugas' : 'Tambah Tugas'}
            </button>
            <button
              onClick={() => setShowFilters(!showFilters)}
              className="bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-lg flex items-center gap-2 transition-colors shadow-md"
            >
              <i data-feather="filter" className="w-5 h-5"></i>
              Filter
            </button>
            <div className="relative flex-grow max-w-md">
              <input
                type="text"
                placeholder="Cari tugas, PIC, atau rincian..."
                value={filters.search}
                onChange={(e) => setFilters(prev => ({ ...prev, search: e.target.value }))}
                className="w-full p-2 pl-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent shadow-sm"
              />
              <i data-feather="search" className="absolute left-3 top-2.5 text-gray-400 w-5 h-5"></i>
            </div>
          </div>

          {showForm && (
            <div className="bg-gray-50 p-6 rounded-lg mb-6 border shadow-md">
              <h2 className="text-xl font-semibold mb-4 text-indigo-900">{editingTaskId ? 'Edit Tugas' : 'Tambah Tugas Baru'}</h2>
              <div className="space-y-4">
                <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-1">
                      Pemberi Tugas *
                    </label>
                    <select
                      value={formData.pemberiTugas}
                      onChange={(e) => handleInputChange('pemberiTugas', e.target.value)}
                      className="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent shadow-sm"
                      required
                    >
                      <option value="">Pilih Pemberi Tugas</option>
                      {pemberiTugasOptions.map(option => (
                        <option key={option} value={option}>{option}</option>
                      ))}
                    </select>
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-1">
                      Sifat Disposisi *
                    </label>
                    <select
                      value={formData.sifatDisposisi}
                      onChange={(e) => handleInputChange('sifatDisposisi', e.target.value)}
                      className="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent shadow-sm"
                      required
                    >
                      {sifatDisposisiOptions.map(option => (
                        <option key={option.value} value={option.value}>{option.value}</option>
                      ))}
                    </select>
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-1">
                      Deadline *
                    </label>
                    <input
                      type="date"
                      value={formData.deadline}
                      onChange={(e) => handleInputChange('deadline', e.target.value)}
                      className="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent shadow-sm"
                      required
                    />
                  </div>
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">
                    Judul Tugas * (max 100 karakter)
                  </label>
                  <input
                    type="text"
                    value={formData.judulTugas}
                    onChange={(e) => handleInputChange('judulTugas', e.target.value)}
                    maxLength={100}
                    className="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent shadow-sm"
                    placeholder="Masukkan judul tugas"
                    required
                  />
                  <div className="text-sm text-gray-500 mt-1">
                    {formData.judulTugas.length}/100 karakter
                  </div>
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">
                    Rincian Tugas
                  </label>
                  <textarea
                    value={formData.rincianTugas}
                    onChange={(e) => handleInputChange('rincianTugas', e.target.value)}
                    rows={4}
                    className="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent shadow-sm"
                    placeholder="Masukkan rincian tugas dengan format:&#10;â€¢ Tugas pertama&#10;â€¢ Tugas kedua&#10;â€¢ Tugas ketiga"
                  />
                  <div className="text-sm text-gray-500 mt-1">
                    ðŸ’¡ Gunakan format bullet (â€¢ atau -) untuk membuat checklist tracking progress
                  </div>
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">
                    Disposisi/PIC
                  </label>
                  <div className="grid grid-cols-2 md:grid-cols-4 gap-2">
                    {picOptions.map(pic => (
                      <label key={pic} className="flex items-center space-x-2 cursor-pointer">
                        <input
                          type="checkbox"
                          checked={formData.disposisiPIC.includes(pic)}
                          onChange={() => handlePICToggle(pic)}
                          className="rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"
                        />
                        <span className="text-sm">{pic}</span>
                      </label>
                    ))}
                  </div>
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">
                    Status
                  </label>
                  <select
                    value={formData.status}
                    onChange={(e) => handleInputChange('status', e.target.value)}
                    className="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent shadow-sm"
                  >
                    {statusOptions.map(status => (
                      <option key={status.value} value={status.value}>{status.value}</option>
                    ))}
                  </select>
                </div>
                <div className="flex gap-3 pt-4">
                  <button
                    onClick={handleSubmit}
                    className="bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-2 rounded-lg transition-colors shadow-md"
                  >
                    {editingTaskId ? 'Update Tugas' : 'Simpan Tugas'}
                  </button>
                  <button
                    onClick={resetForm}
                    className="bg-gray-100 hover:bg-gray-200 text-gray-700 px-6 py-2 rounded-lg transition-colors shadow-md"
                  >
                    Reset Form
                  </button>
                  <button
                    onClick={() => setShowForm(false)}
                    className="bg-red-100 hover:bg-red-200 text-red-700 px-6 py-2 rounded-lg transition-colors shadow-md"
                  >
                    Batal
                  </button>
                </div>
              </div>
            </div>
          )}

          {showFilters && (
            <div className="bg-gray-50 p-4 rounded-lg mb-6 border shadow-md">
              <h3 className="text-lg font-medium mb-3 text-indigo-900">Filter Data</h3>
              <div className="grid grid-cols-1 md:grid-cols-5 gap-4">
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">Pemberi Tugas</label>
                  <select
                    value={filters.pemberiTugas}
                    onChange={(e) => setFilters(prev => ({ ...prev, pemberiTugas: e.target.value }))}
                    className="w-full p-2 border border-gray-300 rounded-lg shadow-sm"
                  >
                    <option value="">Semua</option>
                    {pemberiTugasOptions.map(option => (
                      <option key={option} value={option}>{option}</option>
                    ))}
                  </select>
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">PIC</label>
                  <input
                    type="text"
                    value={filters.pic}
                    onChange={(e) => setFilters(prev => ({ ...prev, pic: e.target.value }))}
                    placeholder="Cari PIC..."
                    className="w-full p-2 border border-gray-300 rounded-lg shadow-sm"
                  />
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">Status</label>
                  <select
                    value={filters.status}
                    onChange={(e) => setFilters(prev => ({ ...prev, status: e.target.value }))}
                    className="w-full p-2 border border-gray-300 rounded-lg shadow-sm"
                  >
                    <option value="">Semua</option>
                    {statusOptions.map(status => (
                      <option key={status.value} value={status.value}>{status.value}</option>
                    ))}
                  </select>
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">Sifat Disposisi</label>
                  <select
                    value={filters.sifatDisposisi}
                    onChange={(e) => setFilters(prev => ({ ...prev, sifatDisposisi: e.target.value }))}
                    className="w-full p-2 border border-gray-300 rounded-lg shadow-sm"
                  >
                    <option value="">Semua</option>
                    {sifatDisposisiOptions.map(option => (
                      <option key={option.value} value={option.value}>{option.value}</option>
                    ))}
                  </select>
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">Deadline</label>
                  <input
                    type="date"
                    value={filters.deadline}
                    onChange={(e) => setFilters(prev => ({ ...prev, deadline: e.target.value }))}
                    className="w-full p-2 border border-gray-300 rounded-lg shadow-sm"
                  />
                </div>
              </div>
              <button
                onClick={() => setFilters({ pemberiTugas: '', pic: '', status: '', deadline: '', sifatDisposisi: '', search: '' })}
                className="mt-3 bg-gray-200 hover:bg-gray-300 text-gray-700 px-4 py-2 rounded-lg transition-colors shadow-md"
              >
                Reset Filter
              </button>
            </div>
          )}

          <div className="bg-white border border-gray-200 rounded-lg overflow-hidden shadow-lg">
            <div className="overflow-x-auto">
              <table className="min-w-full divide-y divide-gray-200">
                <thead className="bg-indigo-50">
                  <tr>
                    <th 
                      onClick={() => requestSort('id')}
                      className="px-6 py-3 text-left text-xs font-medium text-indigo-900 uppercase tracking-wider cursor-pointer hover:bg-indigo-100"
                    >
                      ID {sortConfig.key === 'id' && (sortConfig.direction === 'asc' ? 'â†‘' : 'â†“')}
                    </th>
                    <th 
                      onClick={() => requestSort('pemberiTugas')}
                      className="px-6 py-3 text-left text-xs font-medium text-indigo-900 uppercase tracking-wider cursor-pointer hover:bg-indigo-100"
                    >
                      Pemberi Tugas {sortConfig.key === 'pemberiTugas' && (sortConfig.direction === 'asc' ? 'â†‘' : 'â†“')}
                    </th>
                    <th 
                      onClick={() => requestSort('judulTugas')}
                      className="px-6 py-3 text-left text-xs font-medium text-indigo-900 uppercase tracking-wider cursor-pointer hover:bg-indigo-100"
                    >
                      Judul Tugas {sortConfig.key === 'judulTugas' && (sortConfig.direction === 'asc' ? 'â†‘' : 'â†“')}
                    </th>
                    <th className="px-6 py-3 text-left text-xs font-medium text-indigo-900 uppercase tracking-wider">
                      Rincian Tugas & Progress
                    </th>
                    <th 
                      onClick={() => requestSort('disposisiPIC')}
                      className="px-6 py-3 text-left text-xs font-medium text-indigo-900 uppercase tracking-wider cursor-pointer hover:bg-indigo-100"
                    >
                      Disposisi/PIC {sortConfig.key === 'disposisiPIC' && (sortConfig.direction === 'asc' ? 'â†‘' : 'â†“')}
                    </th>
                    <th 
                      onClick={() => requestSort('sifatDisposisi')}
                      className="px-6 py-3 text-left text-xs font-medium text-indigo-900 uppercase tracking-wider cursor-pointer hover:bg-indigo-100"
                    >
                      Sifat Disposisi {sortConfig.key === 'sifatDisposisi' && (sortConfig.direction === 'asc' ? 'â†‘' : 'â†“')}
                    </th>
                    <th 
                      onClick={() => requestSort('deadline')}
                      className="px-6 py-3 text-left text-xs font-medium text-indigo-900 uppercase tracking-wider cursor-pointer hover:bg-indigo-100"
                    >
                      Deadline {sortConfig.key === 'deadline' && (sortConfig.direction === 'asc' ? 'â†‘' : 'â†“')}
                    </th>
                    <th 
                      onClick={() => requestSort('status')}
                      className="px-6 py-3 text-left text-xs font-medium text-indigo-900 uppercase tracking-wider cursor-pointer hover:bg-indigo-100"
                    >
                      Status {sortConfig.key === 'status' && (sortConfig.direction === 'asc' ? 'â†‘' : 'â†“')}
                    </th>
                    <th className="px-6 py-3 text-left text-xs font-medium text-indigo-900 uppercase tracking-wider">
                      Aksi
                    </th>
                  </tr>
                </thead>
                <tbody className="divide-y divide-gray-200">
                  {filteredAndSortedTasks.map((task, index) => (
                    <tr 
                      key={task.id} 
                      className={`table-row ${index % 2 === 0 ? 'bg-white' : 'bg-gray-50'} ${getProgressBgColor(task)}`}
                    >
                      <td className="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">
                        {task.id}
                        {isHighPriority(task.sifatDisposisi) && (
                          <span className="ml-2 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">
                            Prioritas
                          </span>
                        )}
                      </td>
                      <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                        {task.pemberiTugas}
                      </td>
                      <td className="px-6 py-4 text-sm text-gray-900 max-w-xs">
                        <div className="break-words">{task.judulTugas}</div>
                      </td>
                      <td className="px-6 py-4 text-sm text-gray-900 max-w-md">
                        <div className="space-y-2">
                          <div className="whitespace-pre-wrap break-words text-gray-600 text-xs">
                            {task.rincianTugas}
                          </div>
                          {task.taskItems && task.taskItems.length > 0 && (
                            <div className="space-y-1">
                              <div className={`text-xs font-medium ${getProgressColor(task)}`}>
                                Progress: {getTaskProgress(task)}% ({task.taskItems.filter(item => item.completed).length}/{task.taskItems.length})
                              </div>
                              <div className="space-y-1 max-h-32 overflow-y-auto">
                                {task.taskItems.map(item => (
                                  <label key={item.id} className="flex items-start space-x-2 cursor-pointer text-xs">
                                    <input
                                      type="checkbox"
                                      checked={item.completed}
                                      onChange={() => toggleTaskItem(task.id, item.id)}
                                      className="mt-0.5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"
                                    />
                                    <span className={`${item.completed ? 'line-through text-gray-400' : 'text-gray-700'}`}>
                                      {item.text}
                                    </span>
                                  </label>
                                ))}
                              </div>
                              <div className="w-full bg-gray-200 rounded-full h-1.5 mt-2">
                                <div 
                                  className={`h-1.5 rounded-full transition-all duration-300 ${
                                    getTaskProgress(task) === 100 ? 'bg-green-500' : 
                                    getProgressColor(task) === 'text-red-600' ? 'bg-red-500' :
                                    getProgressColor(task) === 'text-yellow-600' ? 'bg-yellow-500' : 'bg-indigo-500'
                                  }`}
                                  style={{width: `${getTaskProgress(task)}%`}}
                                ></div>
                              </div>
                            </div>
                          )}
                        </div>
                      </td>
                      <td className="px-6 py-4 text-sm text-gray-900">
                        <div className="flex flex-wrap gap-1">
                          {task.disposisiPIC.map(pic => (
                            <span 
                              key={pic}
                              className="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800"
                            >
                              {pic}
                            </span>
                          ))}
                        </div>
                      </td>
                      <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                        <div className="flex flex-col gap-1">
                          <span className={`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${getSifatDisposisiColor(task.sifatDisposisi)}`}>
                            {isHighPriority(task.sifatDisposisi) && <span className="mr-1">ðŸ”¥</span>}
                            {task.sifatDisposisi}
                          </span>
                        </div>
                      </td>
                      <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                        <div className={`${
                          getProgressColor(task) === 'text-red-600' ? 'text-red-600 font-semibold' : 
                          getProgressColor(task) === 'text-yellow-600' ? 'text-yellow-600 font-semibold' :
                          getProgressColor(task) === 'text-green-600' ? 'text-green-600 font-semibold' : ''
                        }`}>
                          {task.deadline}
                          {getProgressColor(task) === 'text-red-600' && (
                            <div className="text-xs text-red-500 mt-1">ðŸ”´ Overdue</div>
                          )}
                          {getProgressColor(task) === 'text-yellow-600' && (
                            <div className="text-xs text-yellow-600 mt-1">ðŸŸ¡ â‰¤ 2 minggu</div>
                          )}
                          {getProgressColor(task) === 'text-green-600' && (
                            <div className="text-xs text-green-600 mt-1">ðŸŸ¢ Done</div>
                          )}
                        </div>
                      </td>
                      <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                        <div className="flex flex-col gap-1">
                          <div className="flex items-center gap-2">
                            <span className={`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${getStatusColor(task.status)}`}>
                              {task.status}
                            </span>
                            {task.taskItems && task.taskItems.length > 0 && (
                              <div className="text-xs text-gray-500">
                                (Auto-sync)
                              </div>
                            )}
                          </div>
                          {(!task.taskItems || task.taskItems.length === 0) && (
                            <select
                              value={task.status}
                              onChange={(e) => updateTaskStatus(task.id, e.target.value)}
                              className="text-xs border border-gray-300 rounded px-1 py-0.5 bg-white"
                            >
                              {statusOptions.map(status => (
                                <option key={status.value} value={status.value}>{status.value}</option>
                              ))}
                            </select>
                          )}
                          {task.status === 'Proses' && task.taskItems && task.taskItems.length > 0 && (
                            <div className="w-full bg-gray-200 rounded-full h-2 mt-1">
                              <div className="bg-indigo-600 h-2 rounded-full animate-pulse" style={{width: `${getTaskProgress(task)}%`}}></div>
                            </div>
                          )}
                        </div>
                      </td>
                      <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                        <div className="flex gap-2">
                          <button
                            onClick={() => handleEditTask(task)}
                            className="bg-indigo-100 hover:bg-indigo-200 text-indigo-800 px-2 py-1 rounded-lg flex items-center gap-1 text-xs transition-colors btn-icon"
                            title="Edit Tugas"
                          >
                            <i data-feather="edit" className="w-4 h-4"></i>
                            Edit
                          </button>
                          <button
                            onClick={() => handleDeleteTask(task.id)}
                            className="bg-red-100 hover:bg-red-200 text-red-800 px-2 py-1 rounded-lg flex items-center gap-1 text-xs transition-colors btn-icon"
                            title="Hapus Tugas"
                          >
                            <i data-feather="trash-2" className="w-4 h-4"></i>
                            Hapus
                          </button>
                        </div>
                      </td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
            {filteredAndSortedTasks.length === 0 && (
              <div className="text-center py-8 text-gray-500">
                Tidak ada data yang sesuai dengan filter
              </div>
            )}
          </div>

          <div className="mt-6 grid grid-cols-1 md:grid-cols-4 gap-4">
            <div className="bg-indigo-50 p-4 rounded-lg shadow-md">
              <div className="text-2xl font-bold text-indigo-600">{tasks.length}</div>
              <div className="text-sm text-indigo-800">Total Tugas</div>
            </div>
            <div className="bg-yellow-50 p-4 rounded-lg shadow-md">
              <div className="text-2xl font-bold text-yellow-600">
                {tasks.filter(t => t.status === 'Proses').length}
              </div>
              <div className="text-sm text-yellow-800">Dalam Proses</div>
            </div>
            <div className="bg-green-50 p-4 rounded-lg shadow-md">
              <div className="text-2xl font-bold text-green-600">
                {tasks.filter(t => t.status === 'Selesai' || t.status === 'Diverifikasi').length}
              </div>
              <div className="text-sm text-green-800">Selesai</div>
            </div>
            <div className="bg-red-50 p-4 rounded-lg shadow-md">
              <div className="text-2xl font-bold text-red-600">
                {tasks.filter(t => {
                  const today = new Date();
                  const deadline = new Date(t.deadline);
                  return deadline < today && getTaskProgress(t) < 100;
                }).length}
              </div>
              <div className="text-sm text-red-800">Overdue</div>
            </div>
            <div className="bg-yellow-50 p-4 rounded-lg shadow-md">
              <div className="text-2xl font-bold text-yellow-600">
                {tasks.filter(t => {
                  const today = new Date();
                  const deadline = new Date(t.deadline);
                  const diffDays = Math.ceil((deadline - today) / (1000 * 60 * 60 * 24));
                  return diffDays <= 14 && diffDays > 0 && getTaskProgress(t) < 100;
                }).length}
              </div>
              <div className="text-sm text-yellow-800">Warning (â‰¤2 minggu)</div>
            </div>
          </div>
        </div>
      );
    };

    ReactDOM.render(<DashboardTindakLanjut />, document.getElementById('root'));
  </script>
</body>
</html>